!function(e){function t(t){for(var r,i,s=t[0],l=t[1],c=t[2],u=0,g=[];u<s.length;u++)i=s[u],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&g.push(n[i][0]),n[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);for(d&&d(t);g.length;)g.shift()();return a.push.apply(a,c||[]),o()}function o(){for(var e,t=0;t<a.length;t++){for(var o=a[t],r=!0,s=1;s<o.length;s++){var l=o[s];0!==n[l]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=o[0]))}return e}var r={},n={"web/SimilarGroups":0},a=[];function i(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=r,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(o,r,function(t){return e[t]}.bind(null,r));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/js/cmodules/";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var d=l;a.push([88,"vendors","common","b0203713c9b55abc70d41e4f64d46e60","741dda01819bf553677f55f828f0ed4b"]),o()}({"16Al":function(e,t,o){"use strict";var r=o("WbBG");function n(){}function a(){}a.resetWarningCache=n,e.exports=function(){function e(e,t,o,n,a,i){if(i!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var o={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:n};return o.PropTypes=o,o}},"17x9":function(e,t,o){e.exports=o("16Al")()},"4Rjc":function(e,t,o){"use strict";o.r(t);var r=o("qJqe");window.SimilarGroups=new r.SimilarGroups;try{stManager.done(jsc("web/SimilarGroups.js"))}catch(e){}},"7juf":function(e,t,o){"use strict";o.r(t),o.d(t,"default",(function(){return F})),o.d(t,"SimilarGroupsEventLog",(function(){return R}));o("HEwt"),o("a1Th"),o("Btvt"),o("rGqo"),o("rE2o"),o("ioFf"),o("91GP"),o("KKXr");var r=o("Egk5"),n=o("zxIV"),a=o("lXE5"),i=o("gdug"),s=o("t7n3"),l=o("v+DW"),c=o("q1tI"),d=o("i8i4"),u=o("Xu7z"),g=o("4+be"),h=o("FWc3"),p=o("6krn"),b=o("EasH"),_=o("Xrg9");function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var o=[],r=!0,n=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(o.push(i.value),!t||o.length!==t);r=!0);}catch(e){n=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(o);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e}).apply(this,arguments)}var O="groups_edit_event_log",j="groups_edit_event_log",w=/act=a_event_log_extended/i,y=()=>{for(var e=ge("groups_edit_action_log_datepicker"),t=Object(n.domPN)(e),o=[],i=0;i<13;i++)o.push(Object(g.getLang)("month"+i+"_of"));function l(e){var t=e.startDate,r=e.endDate,n=Object(g.langDate)(t,Object(g.getLang)("global_short_date","raw"),0,o,!1),a=Object(g.langDate)(r,Object(g.getLang)("global_short_date","raw"),0,o,!1),i=Object(g.langDate)(t,["","{day} {month} {year}"],0,o,!1),s=Object(g.langDate)(r,["","{day} {month} {year}"],0,o,!1),l=Object(g.langDate)(t,["","{day} {month}"],0,o,!1),c=Object(g.langDate)(r,["","{day} {month}"],0,o,!1);return/\d/.test(n[0])||/\d/.test(a[0])?t.getYear()!==r.getYear()?i===s?i:i+" - "+s:l===c?l:l+" - "+c:n===a?n:n+" - "+a}var h=Object(s.intval)(Object(n.domData)(e,"start_date")),b=Object(s.intval)(Object(n.domData)(e,"end_date")),_={startDate:new Date,endDate:new Date};h&&b&&(_.startDate=new Date(1e3*h),_.endDate=new Date(1e3*b));var m=Object(g.getLang)("groups_edit_filter_all_time");nav.objLoc.start_date&&nav.objLoc.end_date&&(m=l(_)),val(e,m);var f=ce("div",{id:"groups_edit_action_log_datepicker_container"});Object(r.addEvent)(f,"click",e=>{Object(s.isFunction)(e.target.onclick)||window.cancelEvent(e)}),document.body.appendChild(f);var O=()=>{var t=e.getBoundingClientRect().height,o=e.getBoundingClientRect().left,r=e.getBoundingClientRect().top+Object(a.scrollGetY)();setStyle(f,{top:r+t+16+"px",left:o-110+"px",position:"absolute"})},j=!1;function w(t){var o=t.startDate,r=t.endDate;_={startDate:o,endDate:r},val(e,l(t)),window.GroupsEditEventLog.filterDate(_),d.unmountComponentAtNode(f),j=!1}var y=()=>{d.unmountComponentAtNode(f),j=!1},L=()=>{_={startDate:null,endDate:null},val(e,Object(g.getLang)("groups_edit_filter_all_time")),window.GroupsEditEventLog.filterDate(_),d.unmountComponentAtNode(f),j=!1};Object(r.addEvent)(t,"click",()=>{var e,t;j?y():(O(),e=f,t={onClose:L,onDone:w,ranges:{range1:_},minDate:new Date(2007,1)},d.render(c.createElement(u.default,v({closeText:Object(p.getLang)("groups_edit_filter_clear_date"),className:"groups_edit_datepicker",maxDate:new Date},t)),e),j=!0)});var x=o=>{o.target===f||o.target===e||o.target===t||hasClass(o.target,"Panel__arrow--plus")||hasClass(o.target,"Panel__arrow--minus")||y()};Object(r.addEvent)(window,"click",x),Object(r.addEvent)(window,"resize",O),Object(r.addEvent)(window,"scroll",x),cur.destroy.push(()=>Object(r.removeEvent)(window,"click",x)),cur.destroy.push(()=>Object(r.removeEvent)(window,"resize",O)),cur.destroy.push(()=>Object(r.removeEvent)(window,"scroll",x)),cur.destroy.push(()=>D())};var L=(e,t,o)=>(Object(r.cancelEvent)(o),function(e){var t="groups"+e+"Filter";return window.cur[t]||{}}(e).goToLink(t,o,!0),!1),x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=ge(j),r=clone(nav.objLoc);Object(s.each)(e,(e,t)=>{r[e]=t});var a=clone(r);delete a[0],delete a.act,cur.disableAutoMore=!0,o.xhr&&(o.xhr.abort(),delete o.xhr),o.xhr=ajax.post(A()+"?act=event_log",extend(a,{filter:1}),{showProgress(){Object(s.isFunction)(t.showProgress)?t.showProgress():T()},hideProgress(){Object(s.isFunction)(t.hideProgress)?t.hideProgress():C()},onDone(e){if(t.isMore){if(!e)return void k(!1);Object(n.sech)(e).forEach(e=>o.appendChild(e)),Object(s.isFunction)(t.onDone)&&t.onDone()}else nav.setLoc(r),scrollToTop(0),val(o,e);cur.disableAutoMore=!1,I(),window.tooltips&&tooltips.destroyAll(),t.clearAjaxCache&&D(),t.noHideItems&&M()}})},D=()=>{Object(s.each)(window.ajaxCache,e=>{w.test(e)&&delete window.ajaxCache[e]})},E=e=>`${e.getDate()}-${e.getMonth()+1}-${e.getFullYear()}`,T=()=>{show(O+"_loader"),hide(O+"_extended_button")},C=()=>{hide(O+"_loader"),show(O+"_extended_button")},P=O+"_more",k=e=>Object(n.toggle)(P,e),S=()=>{if(G(),!i.browser.mobile&&!cur.disableAutoMore){var e=document.documentElement,t=window.innerHeight||e.clientHeight||bodyNode.clientHeight,o=Object(a.scrollGetY)(),r=ge(P);Object(n.isVisible)(r)&&!Object(l.isButtonLocked)(r)&&o+3*t>r.offsetTop&&r.onclick()}},I=()=>{var e,t;e=Object(n.domLC)(ge(j)),t=Object(n.domData)(e,"date"),k(!!t),S(),G()},B=()=>{Object(r.removeEvent)(window,"scroll",S),Object(r.removeEvent)(window,"resize",S)},N=e=>{var t="";return e.forEach(e=>{t+=(e=>{var t="";e.fields.forEach(e=>{e.text?t+=Object(s.getTemplate)("eventLogItemFieldText",e):e.title?t+=Object(s.getTemplate)("eventLogItemFieldTitle",e):t+=Object(s.getTemplate)("eventLogItemField",e)});var o="";e.counter>1&&(o=Object(s.getTemplate)("eventLogItemRowCounter",{counter:e.counter}));var r="";e.photo&&(r=Object(s.getTemplate)("eventLogItemRowPhoto",{link:e.link,photo:e.photo,counter:o}));var n=e.id+(e.additional?"_main":""),a=Object(s.getTemplate)("eventLogItemRow",{date:e.date,row_id:n,actions:e.actions,fields:t,photo:r});return e.additional&&(a=Object(s.getTemplate)("eventLogItem",{id:e.id,item:a,additional:e.additional})),a})(e)}),t},G=()=>{var e=ge(O);if(e){var t=Object(a.scrollGetY)()+42,o=ge(O+"_controls"),r=window.innerHeight;if(e.scrollHeight<=r)Object(n.toggleClass)(o,O+"_controls_fixed",!1);else{var i=geByClass("_groups_edit_event_log_title",e),l=Object(n.getXY)(Object(n.domPN)(o))[1];if(Object(n.toggleClass)(o,O+"_controls_fixed",l<=t),i&&i.length){var c=!1,d=!1;for(var u in t+=47,i){if(Object(n.getXY)(i[u])[1]>=t)break;c=i[u];var g=Object(s.intval)(u)+1;d=!!i[g]&&Object(n.getXY)(i[g])[1]-t}var h=(e,t)=>{Object(n.toggleClass)(e,O+"_title_fixed",t),setStyle(e,{left:t?Object(n.getXY)(Object(n.domPN)(e))[0]:null}),!1===t&&Object(n.removeClass)(e,O+"_title_animating")};if(c){var p=Object(n.domFC)(c);c===e.fixedTitleWrap?setTimeout(()=>h(e.fixedTitle,!0)):(e.fixedTitle&&h(e.fixedTitle,!1),e.fixedTitle=p,h(p,!0),e.fixedTitleWrap=c);var b=!1!==d?d-48:0;b>=0&&(b=0),Object(s.intval)(Object(n.getStyle)(e.fixedTitle,"top"))!==b?(setStyle(e.fixedTitle,{top:b}),Object(n.addClass)(e.fixedTitle,O+"_title_animating")):Object(n.removeClass)(e.fixedTitle,O+"_title_animating")}else e.fixedTitle&&(h(e.fixedTitle,!1),e.fixedTitle=!1,e.fixedTitleWrap=!1)}}}},A=()=>nav.objLoc[0],M=()=>{var e=ge(j),t=JSON.parse(Object(n.domData)(e,"toggled")||"{}")||{};t&&(Object(s.each)(t,e=>{ge(`${O}_item_wrap${e}`)?window.GroupsEditEventLog.toggleItems(e):delete t[e]}),Object(n.domData)(e,"toggled",JSON.stringify(t)))};class F{showMore(){if(nav.objLoc.start_date&&nav.objLoc.end_date)k(!1);else{var e=Object(n.domLC)(ge(j)),t=Object(n.domData)(e,"date");if(!t)return k(!1);x({more_from:t},{showProgress:()=>Object(l.lockButton)(P),hideProgress:()=>Object(l.unlockButton)(P),isMore:!0,onDone(){var e=Object(n.domLC)(ge(j));Object(n.domData)(e,"date")===t&&k(!1)}})}}showToggleItemsTitle(e,t){var o=Object(n.domPN)(Object(n.domPN)(e)),r="";if(hasClass(o,O+"_item_wrap_active")){r=Object(g.getLang)("groups_edit_filter_hide");var a=geByClass1(t+"_additional",o);JSON.parse(Object(n.domData)(a,"additional")).length>1&&(r=Object(g.getLang)("groups_edit_filter_hide_all"))}else r=Object(g.getLang)("groups_edit_filter_more");Object(h.showTitle)(e,r,[-8,1,1],{needLeft:!0,className:O+"_tooltip_item"})}showExtendedButtonTitle(e){var t=Object(s.intval)(Object(n.domData)(e,"mode")),o="";1===t?o=Object(g.getLang)("groups_edit_action_log_simple_tooltip"):0===t&&(o=Object(g.getLang)("groups_edit_action_log_extended_tooltip")),Object(h.showTitle)(e,o,[-16,7,1],{needLeft:!0,className:O+"_tooltip"})}toggleItems(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=ge(`${O}_item_wrap${e}`);if(t&&t.target&&!o){var i=t.target;if(geByClass1(e+"_toggle",a)!==i&&("a"===i.nodeName.toLowerCase()||i.onclick||i.mousedown||i.mouseup||hasClass(i,"_no_toggle")))return;Object(r.cancelEvent)(t)}window.tooltips&&tooltips.destroyAll();var c=O+"_item_wrap_active",d=O+"_item_wrap_loading",u=O+"_item_wrap_focused",g=geByClass1(e+"_more",a),h=geByClass1(e+"_additional",a),p=geByClass1(e+"_content",a),b=JSON.parse(Object(n.domData)(h,"additional")),_=b.length,m=geByClass1(e+"_more_loader",a);if(!m.loading)if(g.inited||(g.inited=!0,Object(r.addEvent)(g,"click",()=>this.toggleItems(e,!1,!0))),!o&&hasClass(Object(n.domPN)(a),O+"_list")&&((e,t)=>{var o=ge(j),r=JSON.parse(Object(n.domData)(o,"toggled")||"{}")||{};t?r[e]||(r[e]=1):r[e]&&delete r[e],Object(n.domData)(o,"toggled",JSON.stringify(r))})(e,!hasClass(a,c)),!hasClass(a,c)||o){if(hasClass(a,d))return;h.page||(h.page=0);var f=b[h.page],v=()=>{var e=h.page<_;Object(n.toggle)(g,e),Object(n.toggle)(m,e)};v(),ajax.post(A()+"?act=a_event_log_extended",{hash:f[0],rows:JSON.stringify(f[1]),mode:Object(s.intval)(nav.objLoc.mode)},{cache:1,showProgress:()=>{o?(Object(l.showProgress)(m),m.loading=!0):Object(n.addClass)(a,d)},hideProgress:()=>{o?(Object(l.hideProgress)(m),m.loading=!1):Object(n.removeClass)(a,d)},onDone:e=>{Object(n.addClass)(a,c),h.page++,v(),isArray(e)&&(e=N(e)),o?Object(n.sech)(e).forEach(e=>p.appendChild(e)):(val(p,e),Object(n.addClass)(a,u),a.timeout&&(clearTimeout(a.timeout),delete a.timeout),a.timeout=setTimeout(()=>Object(n.removeClass)(a,u),1500))}})}else h.page=0,Object(n.removeClass)(a,c),Object(n.removeClass)(a,d)}toggleExtended(e){var t=1===Object(s.intval)(Object(n.domData)(e,"mode"))?0:1,o=O+"_extended_button_simple";1===t?Object(n.addClass)(e,o):Object(n.removeClass)(e,o),Object(n.domData)(e,"mode",t),x({mode:t},{clearAjaxCache:!0,noHideItems:!0})}filterDate(e){var t=e.startDate?E(e.startDate):null,o=e.endDate?E(e.endDate):null;x({start_date:t,end_date:o})}filterRole(e,t,o){return x({role:o}),L("Role",e,t)}filterActionType(e,t,o){return x({action_type:o}),L("ActionType",e,t)}viewPhoto(e){var t=`<img src="${m(e,1)[0]}" width="100%" height="auto" />`;Object(b.showFastBox)({title:Object(g.getLang)(O+"_photo_view_title"),width:700},t)}init(){y(),Object(r.addEvent)(window,"scroll",S),Object(r.addEvent)(window,"resize",S),cur.destroy.push(B),I()}restoreItem(e,t){if(e.loading)return!1;var o=Object(n.domPN)(e),r=geByClass1("_action_loader",o),a=Object(n.domData)(e,"action"),i=Object(n.domData)(e,"hash"),c=Object(s.intval)(nav.objLoc.mode),d=ge(`${O}_item_row${t}`);ajax.post(A()+"?act=a_restore_event_log_item",{action:a,hash:i,mode:c},{showProgress:()=>{e.loading=!0,Object(l.showProgress)(r)},hideProgress:()=>{e.loading=!1,Object(l.hideProgress)(r)},onDone(e){D();var t=se(N(e));domReplaceEl(d,t)}})}}class R{constructor(e){this.groupId=e,this.sendLogsTimeout=null,this.sendLogsProcess=!1,this.localStorageKey="groups_recommends",this.logsDataDelimiter="|"}sendLogs(){clearTimeout(this.sendLogsTimeout),this.sendLogsTimeout=setTimeout(this.sendLogsAccept.bind(this),3e3)}sendLogsAccept(){if(!this.sendLogsProcess){var e=this.getLogs(!0);e.length&&(this.sendLogsProcess=!0,this.clearLogs(),ajax.post("al_groups.php",{act:"a_recommends_logs",logs:e},{onDone:()=>{this.sendLogsProcess=!1},onFail:()=>(this.restoreLogs(e),this.sendLogsProcess=!1,!0)}))}}restoreLogs(e){var t=this.getLogs(),o=[...e.map(e=>e.split(this.logsDataDelimiter)),...t];_.default.set(this.localStorageKey,o)}getLogs(e){var t=_.default.get(this.localStorageKey)||[];return e&&(t=t.map(e=>e.join(this.logsDataDelimiter))),t}addLog(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],i=this.getLogs();i.push([this.groupId,e,t,o,r,n,a]),_.default.set(this.localStorageKey,i),this.sendLogs()}clearLogs(){_.default.remove(this.localStorageKey)}}},88:function(e,t,o){e.exports=o("4Rjc")},"Ht+d":function(e,t,o){"use strict";o.r(t);var r,n=o("q1tI"),a=o("ZxpX"),i=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(){return(s=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},l=function(e,t){var o={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(o[r[n]]=e[r[n]])}return o},c=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,n++)r[n]=a[i];return r};var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){var e=this.props,t=e.className,o=e.appearance,r=e.wide,i=e.overflow,d=e.size,u=l(e,["className","appearance","wide","overflow","size"]),g=e.disabled,h=a.classNames.apply(void 0,c(["Button"],function(e){return Array.isArray(e)?e.map((function(e){return"Button--"+e})):["Button--"+e]}(o),["Button--size-"+d,{"Button--wide":r,"Button--overflow":!!i,"Button--disabled":g},t]));return n.createElement("button",s({},u,{className:h}),e.children)},t.defaultProps={appearance:"primary",size:"m",wide:!1,disabled:!1},t}(n.Component);t.default=d},WbBG:function(e,t,o){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},qJqe:function(e,t,o){"use strict";o.r(t),o.d(t,"EVENT_OPEN_GROUP",(function(){return l})),o.d(t,"EVENT_OPEN_BLOCK",(function(){return c})),o.d(t,"EVENT_HIDE_BLOCK",(function(){return d})),o.d(t,"ACTION_ENTER",(function(){return u})),o.d(t,"ACTION_LEAVE",(function(){return g})),o.d(t,"OPEN_BLOCK_MODE_SUBSCRIBE",(function(){return h})),o.d(t,"OPEN_BLOCK_MODE_FROM_MENU_ITEM",(function(){return p})),o.d(t,"SimilarGroups",(function(){return b}));var r=o("v+DW"),n=o("EasH"),a=o("4+be"),i=o("D1OX"),s=o("7juf"),l="open_group",c="open_group_block",d="hide_group_block",u="enter",g="leave",h="subscribe",p="menu_item";class b{init(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.ownerId=e,this.isEvent=t,this.hash=o,this.block=document.querySelector(".similar_groups_block"),this.block_title=document.querySelector(".similar_groups_block__title"),this.initGalleryBlock(),this.initMenuItem(),this.eventLog=new s.SimilarGroupsEventLog(Math.abs(this.ownerId)),this.issetSimilarGroups()&&isVisible(this.block)&&this.initGallery()}reInit(){this.init(this.ownerId,this.isEvent,this.hash)}initMenuItem(){this.menuItem=document.querySelector(".page_menu_group_similar_recommends"),this.updateMenuItemText()}updateMenuItemText(){null!==this.menuItem&&(isVisible(this.block)?this.menuItem.textContent=Object(a.getLang)("groups_similar_recommends_hide_menu_item"):this.isEvent?this.menuItem.textContent=Object(a.getLang)("groups_similar_events_show_menu_item"):this.menuItem.textContent=Object(a.getLang)("groups_similar_recommends_show_menu_item"))}issetSimilarGroups(){return null!==this.block&&null!==this.menuItem}initGalleryBlock(){this.gallery=document.querySelector(".similar_community_gallery")}initGallery(){null!==this.gallery&&new i.UIGallery(this.gallery)}toggleBlock(){this.issetSimilarGroups()&&(isVisible(this.block)?this.hide():this.show(p))}toggleSubscribeGroup(e,t,o){var r=e.closest(".wall_card"),i=r.dataset.action,s=r.dataset.in_group;if("0"!==r.dataset.group_closed&&"0"!==s&&i!==u)var l=Object(n.showFastBox)({title:Object(a.getLang)("global_warning"),bodyStyle:"padding: 20px; line-height: 160%;"},Object(a.getLang)("groups_group_leave2"),Object(a.getLang)("group_leave_group"),()=>{l.hide(),this._toggleSubscribeGroup(e,t,o)},Object(a.getLang)("global_cancel"));else this._toggleSubscribeGroup(e,t,o);t.preventDefault()}_toggleSubscribeGroup(e,t,o){var i=e.closest(".wall_card"),s=i.dataset.action,l=-i.dataset.group_id,c=s===u?"al_feed.php":"al_fans.php",d={act:s===u?"subscr":"unsub",hash:o,from:"similar_groups"};s===u?d.oid=l:d.id=l,this.eventLog.addLog(s,this.block.dataset.open_mode,i.dataset.index,Math.abs(l),i.dataset.add),ajax.post(c,d,{onDone(t){s===u?(e.classList.add("secondary"),i.dataset.action=g):(e.classList.remove("secondary"),i.dataset.action=u),e.innerHTML=t},onFail(e){if(e)return Object(n.showFastBox)({title:Object(a.getLang)("global_error"),onHide:nav.reload,bodyStyle:"padding: 20px; line-height: 160%;"},e),!0},showProgress:()=>Object(r.lockButton)(e),hideProgress:()=>Object(r.unlockButton)(e)})}show(e){this.issetSimilarGroups()&&(this.block.dataset.open_mode=e,this.isEvent?this.block_title.textContent=Object(a.getLang)("groups_similar_events_recommendations_title"):this.block_title.textContent=Object(a.getLang)("groups_similar_recommendations_title"),null===this.gallery?ajax.post("al_groups.php",{act:"a_recommends_get",owner_id:this.ownerId,hash:this.hash},{onDone:e=>{this.block.insertAdjacentHTML("beforeend",e),this.showBlock()},onFail(e){if(e)return Object(n.showFastBox)({title:Object(a.getLang)("global_error"),bodyStyle:"padding: 20px; line-height: 160%;"},e),!0},showProgress:Page.actionsDropdownLock.pbind(this.menuItem),hideProgress:Page.actionsDropdownUnlock.pbind(this.menuItem)}):this.showBlock())}showBlock(){show(this.block),this.initGalleryBlock(),this.initGallery(),this.updateMenuItemText();var e=[];this.gallery.querySelectorAll(".ui_gallery_item").forEach(t=>e.push(t.dataset.group_id)),this.eventLog.addLog(c,this.block.dataset.open_mode,-1,-1,"",e)}hide(){this.issetSimilarGroups()&&(hide(this.block),this.updateMenuItemText(),this.eventLog.addLog(d,this.block.dataset.open_mode),ajax.post("al_groups.php",{act:"a_recommends_hide",owner_id:this.ownerId,hash:this.hash}))}clickOnGroup(e,t){t.target.closest(".similar_group_subscribe")||this.eventLog.addLog(l,this.block.dataset.open_mode,e.dataset.index,e.dataset.group_id,e.dataset.add)}delRefFromUrl(){nav.objLoc&&"similar_groups_block"===nav.objLoc.from&&(delete nav.objLoc.from,nav.setLoc(nav.objLoc))}}},yLpj:function(e,t){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(e){"object"==typeof window&&(o=window)}e.exports=o}});